eureka:
  client:
    service-url:
      defaultZone: ${EUREKA_HOST:http://localhost:8761/eureka/}

logging:
  level:
    # log eureka client
    org.springframework.cloud.netflix.eureka: DEBUG
    org.springframework.cloud.gateway: DEBUG
    com.etna.gpe.mycloseshop: DEBUG

spring:
  application:
    name: api-gateway
  cloud:
    gateway:
      routes:
        - id: login-service
          uri: ${MS_LOGIN_HOST:http://localhost}:${MS_LOGIN_PORT:8081}${MS_LOGIN_PATH:/api/ms-login-api/}
          #uri: lb://MS-LOGIN-API/api/ms-login-api
          predicates:
            - Path=/api/ms-login-api/**
          filters:
            - name: CircuitBreaker
              args:
                name: login-service
                fallbackUri: forward:/fallback/login

        - id: shop-service
          uri: ${MS_SHOP_HOST:http://localhost}:${MS_SHOP_PORT:8082}${MS_SHOP_PATH:/api/ms-shop-api/}
          #uri: lb://MS-SHOP-API/api/ms-shop-api
          predicates:
              - Path=/api/ms-shop-api/**
          filters:
              - name: CircuitBreaker
                args:
                    name: shop-service
                    fallbackUri: forward:/fallback/shop

      default-filters:
        - name: RemoveRequestHeader
          args:
            name: X-Forwarded-For
        - name: RemoveRequestHeader
          args:
            name: X-Forwarded-Proto
        - name: RemoveRequestHeader
          args:
            name: X-Forwarded-Port
        - name: RemoveRequestHeader
          args:
            name: Forwarded

server:
  port: 8080
  max-http-request-header-size: 16384
